<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="ASA_Save_Inspector.SearchBuilder"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ASA_Save_Inspector"
    xmlns:asi="using:ASA_Save_Inspector"
    xmlns:styling="using:ASA_Save_Inspector.Styling"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:winuiex="using:WinUIEx"
    mc:Ignorable="d"
    Title="ASA Save Inspector Filtering"
    SizeChanged="page_SearchBuilder_SizeChanged"
    Closed="page_SearchBuilder_Closed"
    x:Name="page_SearchBuilder">

    <Window.SystemBackdrop>
        <local:BlurredBackdrop />
    </Window.SystemBackdrop>

    <Grid Background="{StaticResource MyAcrylicBrushDarker}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Popup VerticalOffset="48" HorizontalOffset="0" x:Name="PopupNotification">
            <Popup.Resources>
                <Storyboard x:Name="FadeInStoryboard">
                    <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="b_popupNotification">
                        <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="0" />
                        <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1" />
                    </DoubleAnimationUsingKeyFrames>
                </Storyboard>
                <Storyboard x:Name="FadeOutStoryboard">
                    <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="b_popupNotification">
                        <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="1" />
                        <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="0" />
                    </DoubleAnimationUsingKeyFrames>
                </Storyboard>
            </Popup.Resources>
            <Border x:Name="b_popupNotification" Opacity="0" Width="{Binding ElementName=page_SearchBuilder, Path=WindowWidth, Mode=TwoWay}">
                <Border x:Name="b_innerPopupNotification" Background="DarkGreen"
                        MinWidth="100"
                        Height="Auto"
                        Padding="10"
                        Margin="10"
                        BorderBrush="Transparent"
                        BorderThickness="2"
                        CornerRadius="4"
                        HorizontalAlignment="Right">
                    <TextBlock x:Name="tb_popupNotificationMsg" Text="Message" TextWrapping="WrapWholeWords" FontSize="16" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                </Border>
            </Border>
        </Popup>

        <Grid x:Name="AppTitleBar" Grid.Row="0" Height="48">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="LeftPaddingColumn" Width="0"/>
                <ColumnDefinition x:Name="IconColumn" Width="Auto"/>
                <ColumnDefinition x:Name="TitleColumn" Width="Auto"/>
                <ColumnDefinition x:Name="LeftDragColumn" Width="*"/>
                <ColumnDefinition x:Name="RightPaddingColumn" Width="0"/>
            </Grid.ColumnDefinitions>
            <Image x:Name="TitleBarIcon" Source="ms-appx:///Assets/ASILogo.png" Grid.Column="1" Width="44" Height="44" Margin="8,0,4,0"/>
            <TextBlock x:Name="TitleBarTextBlock" Text="ASA Save Inspector Filtering" Style="{StaticResource CaptionTextBlockStyle}" FontSize="14" Grid.Column="2" VerticalAlignment="Center">
            </TextBlock>
        </Grid>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Left">
            <TextBlock FontSize="14" VerticalAlignment="Center" Margin="10,0,0,0"><Run Text="{x:Bind asi:ASILang.Get('FilterBy'), Mode=OneWay}"/>:</TextBlock>
            <ComboBox x:Name="cbb_LogicalOperator" Margin="10,0,0,0" Visibility="Collapsed">
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('OperatorAND'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('OperatorOR'), Mode=OneWay}"/>
            </ComboBox>
            <ComboBox x:Name="cbb_Property" Margin="10,0,0,0" SelectionChanged="cbb_Property_SelectionChanged"></ComboBox>
            <ComboBox x:Name="cbb_Operator" Margin="10,0,0,0" SelectionChanged="cbb_Operator_SelectionChanged">
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_Matching'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_NotMatching'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_Equals'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_NotEquals'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_StartingWith'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_EndingWith'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_Containing'), Mode=OneWay}"/>
                <ComboBoxItem Content="{x:Bind asi:ASILang.Get('FilterType_NotContaining'), Mode=OneWay}"/>
                <ComboBoxItem x:Name="cbi_LowerThan" Content="{x:Bind asi:ASILang.Get('FilterType_LowerThan'), Mode=OneWay}"/>
                <ComboBoxItem x:Name="cbi_GreaterThan" Content="{x:Bind asi:ASILang.Get('FilterType_GreaterThan'), Mode=OneWay}"/>
            </ComboBox>
            <ComboBox x:Name="cbb_Value" Margin="10,0,0,0" MinWidth="120" Visibility="Collapsed"></ComboBox>
            <TextBox x:Name="tb_Value" Margin="10,0,0,0" MinWidth="120" Visibility="Collapsed"></TextBox>
            <Button x:Name="btn_Add" Content="Add" Margin="10,0,0,0" Click="btn_Add_Click"/>
        </StackPanel>
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Left">
            <TextBlock Text="{x:Bind asi:ASILang.Get('Grouping'), Mode=OneWay}" FontSize="14" VerticalAlignment="Center" Margin="10,0,0,0"/>
            <Button x:Name="btn_StartGroup" Content="{x:Bind asi:ASILang.Get('StartGroup'), Mode=OneWay}" ToolTipService.ToolTip="{x:Bind asi:ASILang.Get('OpenParenthesis'), Mode=OneWay}" Margin="10,0,0,0" Click="btn_StartGroup_Click"/>
            <Button x:Name="btn_EndGroup" Content="{x:Bind asi:ASILang.Get('EndGroup'), Mode=OneWay}" ToolTipService.ToolTip="{x:Bind asi:ASILang.Get('CloseParenthesis'), Mode=OneWay}" Margin="10,0,0,0" Click="btn_EndGroup_Click" IsEnabled="False"/>
            <TextBlock x:Name="tb_CurrentGroupLabel" FontSize="12" VerticalAlignment="Center" Margin="10,0,0,0"><Run Text="{x:Bind asi:ASILang.Get('CurrentGroupLabelStart'), Mode=OneWay}"/><Run x:Name="tb_CurrentGroupLabelValue" Text="0"/><Run Text="{x:Bind asi:ASILang.Get('CurrentGroupLabelEnd'), Mode=OneWay}"/></TextBlock>
        </StackPanel>
        <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Left">
            <Button x:Name="btn_RemovePreviouslyAdded" Content="{x:Bind asi:ASILang.Get('RemovePreviouslyAddedFilter'), Mode=OneWay}" ToolTipService.ToolTip="{x:Bind asi:ASILang.Get('RemovePreviouslyAddedFilter_Tooltip'), Mode=OneWay}" Margin="10,0,0,0" IsEnabled="False" Click="btn_RemovePreviouslyAdded_Click"/>
        </StackPanel>
        <TextBlock Grid.Row="4" Text="{x:Bind asi:ASILang.Get('Preview'), Mode=OneWay}" FontSize="14" Margin="10,10,0,0"/>
        <Border Grid.Row="5"
            BorderBrush="{StaticResource AcrylicInAppFillColorDefaultBrush}" 
            Background="{StaticResource MyAcrylicBrush}"
            BorderThickness="1"
            Margin="10,5,10,0">
            <ScrollViewer x:Name="sv_QueryDisplay">
                <StackPanel x:Name="sp_QueryDisplay" Orientation="Vertical"></StackPanel>
            </ScrollViewer>
        </Border>
        <StackPanel Grid.Row="6" Orientation="Horizontal" Margin="0,10,0,10" VerticalAlignment="Top" HorizontalAlignment="Center">
            <Button x:Name="btn_TryQuery" Content="{x:Bind asi:ASILang.Get('Search'), Mode=OneWay}" Margin="0,0,10,0" Click="btn_TryQuery_Click" Visibility="Collapsed"/>
            <Button x:Name="btn_SaveQuery" Content="{x:Bind asi:ASILang.Get('Save'), Mode=OneWay}" Margin="0,0,10,0" Click="btn_SaveQuery_Click"/>
            <Button x:Name="btn_CancelQuery" Content="{x:Bind asi:ASILang.Get('Cancel'), Mode=OneWay}" Click="btn_CancelQuery_Click"/>
            <TextBlock FontSize="14" VerticalAlignment="Center" Margin="40,0,0,0" Text="{x:Bind asi:ASILang.Get('SavedFilters'), Mode=OneWay}" Visibility="Collapsed" />
            <ComboBox x:Name="cbb_ExistingQueries" Margin="10,0,0,0" SelectionChanged="cbb_ExistingQueries_SelectionChanged" Visibility="Collapsed"></ComboBox>
            <Button x:Name="btn_LoadQuery" Content="{x:Bind asi:ASILang.Get('Load'), Mode=OneWay}" Margin="10,0,0,0" Click="btn_LoadQuery_Click" Visibility="Collapsed" IsEnabled="False"/>
            <Button x:Name="btn_DeleteQuery" Content="{x:Bind asi:ASILang.Get('Remove'), Mode=OneWay}" Margin="10,0,0,0" Click="btn_DeleteQuery_Click" Visibility="Collapsed" IsEnabled="False"/>
        </StackPanel>

        <Popup VerticalOffset="0" HorizontalOffset="0" x:Name="SaveQueryPopup">
            <Border Width="{Binding ElementName=page_SearchBuilder, Path=WindowWidth, Mode=TwoWay}" Height="{Binding ElementName=page_SearchBuilder, Path=WindowHeight, Mode=TwoWay}" VerticalAlignment="Center" HorizontalAlignment="Center">
                <Border BorderBrush="{StaticResource AcrylicInAppFillColorDefaultBrush}" 
                        Background="{StaticResource AcrylicInAppFillColorDefaultBrush}"
                        BorderThickness="2" CornerRadius="4" Margin="20"
                        VerticalAlignment="Center" HorizontalAlignment="Center">
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="10">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock FontSize="14" VerticalAlignment="Center" Margin="10,0,0,0"><Run Text="{x:Bind asi:ASILang.Get('FilterName'), Mode=OneWay}"/>:</TextBlock>
                            <TextBox x:Name="tb_SearchQueryName" FontSize="14" VerticalAlignment="Center" MinWidth="120" MaxWidth="350" Margin="5,0,0,0" Text="" TextChanged="tb_SearchQueryName_TextChanged"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,30,0,0">
                            <Button x:Name="btn_SaveSearchQuery" Content="{x:Bind asi:ASILang.Get('Save'), Mode=OneWay}" Click="btn_SaveSearchQuery_Click" FontSize="18" Margin="10,0,0,0" IsEnabled="False"/>
                            <Button x:Name="btn_CancelSaveSearchQuery" Content="{x:Bind asi:ASILang.Get('Cancel'), Mode=OneWay}" Click="btn_CancelSaveSearchQuery_Click" FontSize="18" Margin="10,0,0,0" />
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
        </Popup>
    </Grid>
</Window>
